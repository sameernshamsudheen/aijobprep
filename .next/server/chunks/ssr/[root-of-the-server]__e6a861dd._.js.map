{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/components/BackLInk.tsx"],"sourcesContent":["\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"./ui/button\"\nimport Link from \"next/link\"\nimport { ArrowLeftIcon } from \"lucide-react\"\n\nexport function BackLink({\n  href,\n  children,\n  className,\n}: {\n  href: string\n  children: React.ReactNode\n  className?: string\n}) {\n  return (\n    <Button\n      asChild\n      variant=\"ghost\"\n      size=\"sm\"\n      className={cn(\"-ml-3\", className)}\n    >\n      <Link\n        href={href}\n        className=\"flex gap-2 items-center text-sm text-muted-foreground\"\n      >\n        <ArrowLeftIcon />\n        {children}\n      </Link>\n    </Button>\n  )\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;;;;;;AAEO,SAAS,SAAS,EACvB,IAAI,EACJ,QAAQ,EACR,SAAS,EAKV;IACC,qBACE,8OAAC,4IAAM;QACL,OAAO;QACP,SAAQ;QACR,MAAK;QACL,WAAW,IAAA,yHAAE,EAAC,SAAS;kBAEvB,cAAA,8OAAC,uKAAI;YACH,MAAM;YACN,WAAU;;8BAEV,8OAAC,qOAAa;;;;;gBACb;;;;;;;;;;;;AAIT","debugId":null}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/features/interviews/dbCache.ts"],"sourcesContent":["import { getGlobalTag, getIdTag, getJobInfoTag } from \"@/lib/dataCache\"\nimport { revalidateTag } from \"next/cache\"\n\nexport function getInterviewGlobalTag() {\n  return getGlobalTag(\"interviews\")\n}\n\nexport function getInterviewJobInfoTag(jobInfoId: string) {\n  return getJobInfoTag(\"interviews\", jobInfoId)\n}\n\nexport function getInterviewIdTag(id: string) {\n  return getIdTag(\"interviews\", id)\n}\n\nexport function revalidateInterviewCache({\n  id,\n  jobInfoId,\n}: {\n  id: string\n  jobInfoId: string\n}) {\n  revalidateTag(getInterviewGlobalTag())\n  revalidateTag(getInterviewJobInfoTag(jobInfoId))\n  revalidateTag(getInterviewIdTag(id))\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,SAAS;IACd,OAAO,IAAA,uIAAY,EAAC;AACtB;AAEO,SAAS,uBAAuB,SAAiB;IACtD,OAAO,IAAA,wIAAa,EAAC,cAAc;AACrC;AAEO,SAAS,kBAAkB,EAAU;IAC1C,OAAO,IAAA,mIAAQ,EAAC,cAAc;AAChC;AAEO,SAAS,yBAAyB,EACvC,EAAE,EACF,SAAS,EAIV;IACC,IAAA,8IAAa,EAAC;IACd,IAAA,8IAAa,EAAC,uBAAuB;IACrC,IAAA,8IAAa,EAAC,kBAAkB;AAClC","debugId":null}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/features/jobinfos/dbCache.ts"],"sourcesContent":["import { getGlobalTag, getIdTag, getUserTag } from \"@/lib/dataCache\"\nimport { revalidateTag } from \"next/cache\"\n\nexport function getJobInfoGlobalTag() {\n  return getGlobalTag(\"jobInfos\")\n}\n\nexport function getJobInfoUserTag(userId: string) {\n  return getUserTag(\"jobInfos\", userId)\n}\n\nexport function getJobInfoIdTag(id: string) {\n  return getIdTag(\"jobInfos\", id)\n}\n\nexport function revalidateJobInfoCache({\n  id,\n  userId,\n}: {\n  id: string\n  userId: string\n}) {\n  revalidateTag(getJobInfoGlobalTag())\n  revalidateTag(getJobInfoUserTag(userId))\n  revalidateTag(getJobInfoIdTag(id))\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,SAAS;IACd,OAAO,IAAA,uIAAY,EAAC;AACtB;AAEO,SAAS,kBAAkB,MAAc;IAC9C,OAAO,IAAA,qIAAU,EAAC,YAAY;AAChC;AAEO,SAAS,gBAAgB,EAAU;IACxC,OAAO,IAAA,mIAAQ,EAAC,YAAY;AAC9B;AAEO,SAAS,uBAAuB,EACrC,EAAE,EACF,MAAM,EAIP;IACC,IAAA,8IAAa,EAAC;IACd,IAAA,8IAAa,EAAC,kBAAkB;IAChC,IAAA,8IAAa,EAAC,gBAAgB;AAChC","debugId":null}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/lib/formatters.ts"],"sourcesContent":["const DATE_TIME_FORMATTER = new Intl.DateTimeFormat(undefined, {\n  dateStyle: \"medium\",\n  timeStyle: \"short\",\n})\nexport function formatDateTime(date: Date) {\n  return DATE_TIME_FORMATTER.format(date)\n}"],"names":[],"mappings":";;;AAAA,MAAM,sBAAsB,IAAI,KAAK,cAAc,CAAC,WAAW;IAC7D,WAAW;IACX,WAAW;AACb;AACO,SAAS,eAAe,IAAU;IACvC,OAAO,oBAAoB,MAAM,CAAC;AACpC","debugId":null}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/components/ui/avatar.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const Avatar = registerClientReference(\n    function() { throw new Error(\"Attempted to call Avatar() from the server but Avatar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx <module evaluation>\",\n    \"Avatar\",\n);\nexport const AvatarFallback = registerClientReference(\n    function() { throw new Error(\"Attempted to call AvatarFallback() from the server but AvatarFallback is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx <module evaluation>\",\n    \"AvatarFallback\",\n);\nexport const AvatarImage = registerClientReference(\n    function() { throw new Error(\"Attempted to call AvatarImage() from the server but AvatarImage is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx <module evaluation>\",\n    \"AvatarImage\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;;AACvE;;AACO,MAAM,SAAS,IAAA,wQAAuB,EACzC;IAAa,MAAM,IAAI,MAAM;AAA4N,GACzP,8DACA;AAEG,MAAM,iBAAiB,IAAA,wQAAuB,EACjD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,8DACA;AAEG,MAAM,cAAc,IAAA,wQAAuB,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,8DACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 141, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/components/ui/avatar.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const Avatar = registerClientReference(\n    function() { throw new Error(\"Attempted to call Avatar() from the server but Avatar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx\",\n    \"Avatar\",\n);\nexport const AvatarFallback = registerClientReference(\n    function() { throw new Error(\"Attempted to call AvatarFallback() from the server but AvatarFallback is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx\",\n    \"AvatarFallback\",\n);\nexport const AvatarImage = registerClientReference(\n    function() { throw new Error(\"Attempted to call AvatarImage() from the server but AvatarImage is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx\",\n    \"AvatarImage\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;;AACvE;;AACO,MAAM,SAAS,IAAA,wQAAuB,EACzC;IAAa,MAAM,IAAI,MAAM;AAA4N,GACzP,0CACA;AAEG,MAAM,iBAAiB,IAAA,wQAAuB,EACjD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,0CACA;AAEG,MAAM,cAAc,IAAA,wQAAuB,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,0CACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/features/users/components/UserAvatar.tsx"],"sourcesContent":["\nimport { ComponentProps } from \"react\"\nimport {\n  Avatar,\n  AvatarFallback,\n  AvatarImage,\n} from \"../../../components/ui/avatar\"\n\nexport function UserAvatar({\n  user,\n  ...props\n}: {\n  user: { name: string; imageUrl: string }\n} & ComponentProps<typeof Avatar>) {\n  return (\n    <Avatar {...props}>\n      <AvatarImage src={user.imageUrl} alt={user.name} />\n      <AvatarFallback className=\"uppercase\">\n        {user.name\n          .split(\" \")\n          .slice(0, 2)\n          .map(n => n[0])\n          .join(\"\")}\n      </AvatarFallback>\n    </Avatar>\n  )\n}\n"],"names":[],"mappings":";;;;AAEA;;;AAMO,SAAS,WAAW,EACzB,IAAI,EACJ,GAAG,OAG4B;IAC/B,qBACE,8OAAC,4IAAM;QAAE,GAAG,KAAK;;0BACf,8OAAC,iJAAW;gBAAC,KAAK,KAAK,QAAQ;gBAAE,KAAK,KAAK,IAAI;;;;;;0BAC/C,8OAAC,oJAAc;gBAAC,WAAU;0BACvB,KAAK,IAAI,CACP,KAAK,CAAC,KACN,KAAK,CAAC,GAAG,GACT,GAAG,CAAC,CAAA,IAAK,CAAC,CAAC,EAAE,EACb,IAAI,CAAC;;;;;;;;;;;;AAIhB","debugId":null}},
    {"offset": {"line": 208, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/services/hume/components/CondensedMessages.tsx"],"sourcesContent":["import { UserAvatar } from \"@/features/users/components/UserAvatar\"\nimport { cn } from \"@/lib/utils\"\nimport { BrainCircuitIcon } from \"lucide-react\"\n\nexport function CondensedMessages({\n  messages,\n  user,\n  className,\n  maxFft = 0,\n}: {\n  messages: { isUser: boolean; content: string[] }[]\n  user: { name: string; imageUrl: string }\n  className?: string\n  maxFft?: number\n}) {\n  return (\n    <div className={cn(\"flex flex-col gap-4 w-full\", className)}>\n      {messages.map((message, index) => {\n        const shouldAnimate = index === messages.length - 1 && maxFft > 0\n\n        return (\n          <div\n            key={index}\n            className={cn(\n              \"flex items-center gap-5 border pl-4 pr-6 py-4 rounded max-w-3/4\",\n              message.isUser ? \"self-end\" : \"self-start\"\n            )}\n          >\n            {message.isUser ? (\n              <UserAvatar user={user} className=\"size-6 flex-shrink-0\" />\n            ) : (\n              <div className=\"relative\">\n                <div\n                  className={cn(\n                    \"absolute inset-0 border-muted border-4 rounded-full\",\n                    shouldAnimate ? \"animate-ping\" : \"hidden\"\n                  )}\n                />\n                <BrainCircuitIcon\n                  className=\"size-6 flex-shrink-0 relative\"\n                  style={shouldAnimate ? { scale: maxFft / 8 + 1 } : undefined}\n                />\n              </div>\n            )}\n            <div className=\"flex flex-col gap-1\">\n              {message.content.map((text, i) => (\n                <span key={i}>{text}</span>\n              ))}\n            </div>\n          </div>\n        )\n      })}\n    </div>\n  )\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;AAEO,SAAS,kBAAkB,EAChC,QAAQ,EACR,IAAI,EACJ,SAAS,EACT,SAAS,CAAC,EAMX;IACC,qBACE,8OAAC;QAAI,WAAW,IAAA,yHAAE,EAAC,8BAA8B;kBAC9C,SAAS,GAAG,CAAC,CAAC,SAAS;YACtB,MAAM,gBAAgB,UAAU,SAAS,MAAM,GAAG,KAAK,SAAS;YAEhE,qBACE,8OAAC;gBAEC,WAAW,IAAA,yHAAE,EACX,mEACA,QAAQ,MAAM,GAAG,aAAa;;oBAG/B,QAAQ,MAAM,iBACb,8OAAC,mKAAU;wBAAC,MAAM;wBAAM,WAAU;;;;;6CAElC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCACC,WAAW,IAAA,yHAAE,EACX,uDACA,gBAAgB,iBAAiB;;;;;;0CAGrC,8OAAC,8OAAgB;gCACf,WAAU;gCACV,OAAO,gBAAgB;oCAAE,OAAO,SAAS,IAAI;gCAAE,IAAI;;;;;;;;;;;;kCAIzD,8OAAC;wBAAI,WAAU;kCACZ,QAAQ,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,kBAC1B,8OAAC;0CAAc;+BAAJ;;;;;;;;;;;eAxBV;;;;;QA6BX;;;;;;AAGN","debugId":null}},
    {"offset": {"line": 291, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/services/hume/lib/condensedChat.tsx"],"sourcesContent":["import { ConnectionMessage } from \"@humeai/voice-react\"\nimport { JsonMessage, ReturnChatEvent } from \"hume/api/resources/empathicVoice\"\n\ntype Message = JsonMessage | ConnectionMessage | ReturnChatEvent\n\nexport function condenseChatMessages(messages: Message[]) {\n  return messages.reduce((acc, message) => {\n    const data = getChatEventData(message) ?? getJsonMessageData(message)\n    if (data == null || data.content == null) {\n      return acc\n    }\n\n    const lastMessage = acc.at(-1)\n    if (lastMessage == null) {\n      acc.push({ isUser: data.isUser, content: [data.content] })\n      return acc\n    }\n\n    if (lastMessage.isUser === data.isUser) {\n      lastMessage.content.push(data.content)\n    } else {\n      acc.push({ isUser: data.isUser, content: [data.content] })\n    }\n\n    return acc\n  }, [] as { isUser: boolean; content: string[] }[])\n}\n\nfunction getJsonMessageData(message: Message) {\n  if (message.type !== \"user_message\" && message.type !== \"assistant_message\") {\n    return null\n  }\n\n  return {\n    isUser: message.type === \"user_message\",\n    content: message.message.content,\n  }\n}\n\nfunction getChatEventData(message: Message) {\n  if (message.type !== \"USER_MESSAGE\" && message.type !== \"AGENT_MESSAGE\") {\n    return null\n  }\n\n  return {\n    isUser: message.type === \"USER_MESSAGE\",\n    content: message.messageText,\n  }\n}"],"names":[],"mappings":";;;AAKO,SAAS,qBAAqB,QAAmB;IACtD,OAAO,SAAS,MAAM,CAAC,CAAC,KAAK;QAC3B,MAAM,OAAO,iBAAiB,YAAY,mBAAmB;QAC7D,IAAI,QAAQ,QAAQ,KAAK,OAAO,IAAI,MAAM;YACxC,OAAO;QACT;QAEA,MAAM,cAAc,IAAI,EAAE,CAAC,CAAC;QAC5B,IAAI,eAAe,MAAM;YACvB,IAAI,IAAI,CAAC;gBAAE,QAAQ,KAAK,MAAM;gBAAE,SAAS;oBAAC,KAAK,OAAO;iBAAC;YAAC;YACxD,OAAO;QACT;QAEA,IAAI,YAAY,MAAM,KAAK,KAAK,MAAM,EAAE;YACtC,YAAY,OAAO,CAAC,IAAI,CAAC,KAAK,OAAO;QACvC,OAAO;YACL,IAAI,IAAI,CAAC;gBAAE,QAAQ,KAAK,MAAM;gBAAE,SAAS;oBAAC,KAAK,OAAO;iBAAC;YAAC;QAC1D;QAEA,OAAO;IACT,GAAG,EAAE;AACP;AAEA,SAAS,mBAAmB,OAAgB;IAC1C,IAAI,QAAQ,IAAI,KAAK,kBAAkB,QAAQ,IAAI,KAAK,qBAAqB;QAC3E,OAAO;IACT;IAEA,OAAO;QACL,QAAQ,QAAQ,IAAI,KAAK;QACzB,SAAS,QAAQ,OAAO,CAAC,OAAO;IAClC;AACF;AAEA,SAAS,iBAAiB,OAAgB;IACxC,IAAI,QAAQ,IAAI,KAAK,kBAAkB,QAAQ,IAAI,KAAK,iBAAiB;QACvE,OAAO;IACT;IAEA,OAAO;QACL,QAAQ,QAAQ,IAAI,KAAK;QACzB,SAAS,QAAQ,WAAW;IAC9B;AACF","debugId":null}},
    {"offset": {"line": 441, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/services/hume/lib/api.ts"],"sourcesContent":["import { serverEnv} from \"@/data/env/server\"\nimport { HumeClient } from \"hume\"\nimport { ReturnChatEvent } from \"hume/api/resources/empathicVoice\"\n\nexport async function fetchChatMessages(humeChatId: string) {\n  \"use cache\"\n\n  const client = new HumeClient({ apiKey: serverEnv.HUME_API_KEY })\n  const allChatEvents: ReturnChatEvent[] = []\n  const chatEventsIterator = await client.empathicVoice.chats.listChatEvents(\n    humeChatId,\n    { pageNumber: 0, pageSize: 100 }\n  )\n\n  for await (const chatEvent of chatEventsIterator) {\n    allChatEvents.push(chatEvent)\n  }\n\n  return allChatEvents\n}\n\n\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;;;IAGO,6SAAA,eAAe,kBAAkB,UAAkB;IAGxD,MAAM,SAAS,IAAI,2IAAU,CAAC;QAAE,QAAQ,yIAAS,CAAC,YAAY;IAAC;IAC/D,MAAM,gBAAmC,EAAE;IAC3C,MAAM,qBAAqB,MAAM,OAAO,aAAa,CAAC,KAAK,CAAC,cAAc,CACxE,YACA;QAAE,YAAY;QAAG,UAAU;IAAI;IAGjC,WAAW,MAAM,aAAa,mBAAoB;QAChD,cAAc,IAAI,CAAC;IACrB;IAEA,OAAO;AACT;;;;;;IAfsB","debugId":null}},
    {"offset": {"line": 477, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\"\n\nexport function Skeleton({ className }: { className?: string }) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n    />\n  )\n}\n"],"names":[],"mappings":";;;;AAAA;;;AAEO,SAAS,SAAS,EAAE,SAAS,EAA0B;IAC5D,qBACE,8OAAC;QACC,WAAW,IAAA,yHAAE,EAAC,qCAAqC;;;;;;AAGzD","debugId":null}},
    {"offset": {"line": 497, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/app/app/job-infos/%5BjobInfoId%5D/interviews/%5BinterviewsId%5D/FeedbackActions.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const FeedbackActions = registerClientReference(\n    function() { throw new Error(\"Attempted to call FeedbackActions() from the server but FeedbackActions is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/app/job-infos/[jobInfoId]/interviews/[interviewsId]/FeedbackActions.tsx <module evaluation>\",\n    \"FeedbackActions\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;AACvE;;AACO,MAAM,kBAAkB,IAAA,wQAAuB,EAClD;IAAa,MAAM,IAAI,MAAM;AAA8O,GAC3Q,iHACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 510, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/app/app/job-infos/%5BjobInfoId%5D/interviews/%5BinterviewsId%5D/FeedbackActions.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const FeedbackActions = registerClientReference(\n    function() { throw new Error(\"Attempted to call FeedbackActions() from the server but FeedbackActions is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/app/job-infos/[jobInfoId]/interviews/[interviewsId]/FeedbackActions.tsx\",\n    \"FeedbackActions\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;AACvE;;AACO,MAAM,kBAAkB,IAAA,wQAAuB,EAClD;IAAa,MAAM,IAAI,MAAM;AAA8O,GAC3Q,6FACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 523, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 533, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/app/app/job-infos/%5BjobInfoId%5D/interviews/%5BinterviewsId%5D/page.tsx"],"sourcesContent":["import { BackLink } from \"@/components/BackLInk\"\nimport { db } from \"@/drizzle/db\"\nimport { InterviewsTable, JobInfoTable } from \"@/drizzle/schema\"\nimport { getInterviewIdTag } from \"@/features/interviews/dbCache\"\nimport { getJobInfoIdTag } from \"@/features/jobinfos/dbCache\"\nimport { formatDateTime } from \"@/lib/formatters\"\nimport { getCurrentUser } from \"@/services/lib/getcurrentUser\"\nimport { and, eq } from \"drizzle-orm\"\nimport { cacheTag } from \"next/dist/server/use-cache/cache-tag\"\nimport { Suspense } from \"react\"\nimport { CondensedMessages } from \"@/services/hume/components/CondensedMessages\"\nimport { condenseChatMessages } from \"@/services/hume/lib/condensedChat\"\nimport { fetchChatMessages } from \"@/services/hume/lib/api\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport { FeedbackActions } from \"./FeedbackActions\"\n\nexport default async function InterviewPage({\n  params,\n}: {\n  params: Promise<{ jobInfoId: string; interviewsId: string }>\n}) {\n  const { jobInfoId, interviewsId } = await params\n\n  const { userId, user, redirectToSignIn } = await getCurrentUser({\n    allData: true,\n  })\n  if (userId == null || user == null) return redirectToSignIn()\n\n  const interviewIds = await getInterviewIdsForJobInfo(jobInfoId, userId)\n  console.log(\"Interview IDs for jobInfo:\", jobInfoId, interviewIds)\n\n  const interview = await getInterview(interviewsId, userId)\n  if (interview == null) {\n    return (\n      <div className=\"container my-4 space-y-4\">\n        <BackLink href={`/app/job-infos/${jobInfoId}/interviews`}>\n          All Interviews\n        </BackLink>\n        <div className=\"max-w-3xl\">\n          <p className=\"text-sm text-muted-foreground\">\n            Interview not found or access denied.\n          </p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"container my-4 space-y-4\">\n      <BackLink href={`/app/job-infos/${jobInfoId}/interviews`}>\n        All Interviews\n      </BackLink>\n      <div className=\"space-y-6\">\n        <div className=\"flex gap-2 justify-between\">\n          <div className=\"space-y-2 mb-6\">\n            <h1 className=\"text-3xl md:text-4xl\">\n              Interview: {formatDateTime(interview.createdAt)}\n            </h1>\n            <p className=\"text-muted-foreground\">\n              {interview.duration}\n            </p>\n          </div>\n          <FeedbackActions\n            interviewId={interview.id}\n            feedback={interview.feedback ?? null}\n          />\n        </div>\n        <Suspense fallback={<MessagesSkeleton />}>\n          <Messages interview={interview} user={user} />\n        </Suspense>\n      </div>\n    </div>\n  )\n}\n\nfunction MessagesSkeleton() {\n  return (\n    <div className=\"max-w-5xl mx-auto space-y-6\">\n      <div className=\"flex items-center gap-3\">\n        <Skeleton className=\"h-10 w-10 rounded-full\" />\n        <div className=\"space-y-2 flex-1\">\n          <Skeleton className=\"h-4 w-40\" />\n          <Skeleton className=\"h-3 w-24\" />\n        </div>\n      </div>\n      <div className=\"space-y-3\">\n        <Skeleton className=\"h-4 w-full\" />\n        <Skeleton className=\"h-4 w-[85%]\" />\n        <Skeleton className=\"h-4 w-[70%]\" />\n      </div>\n      <div className=\"space-y-3\">\n        <Skeleton className=\"h-4 w-[90%]\" />\n        <Skeleton className=\"h-4 w-[75%]\" />\n      </div>\n    </div>\n  )\n}\n\nasync function Messages({\n  interview,\n  user,\n}: {\n  interview: { humeChatId: string | null }\n  user: { name: string; imageUrl: string }\n}) {\n  const { humeChatId } = interview\n\n  if (!humeChatId) {\n    return (\n      <div className=\"max-w-3xl mx-auto\">\n        <p className=\"text-sm text-muted-foreground\">\n          Interview not completed yet. Once the call finishes, the transcript\n          will appear here.\n        </p>\n      </div>\n    )\n  }\n\n  const condensedMessages = condenseChatMessages(\n    await fetchChatMessages(humeChatId)\n  )\n\n  return (\n    <CondensedMessages\n      messages={condensedMessages}\n      user={user}\n      className=\"max-w-5xl mx-auto\"\n    />\n  )\n}\n\nasync function getInterview(id: string, userId: string) {\n  \"use cache\"\n  cacheTag(getInterviewIdTag(id))\n\n  const interview = await db.query.InterviewsTable.findFirst({\n    where: eq(InterviewsTable.id, id),\n    with: {\n      jobInfo: {\n        columns: {\n          id: true,\n          userId: true,\n        },\n      },\n    },\n  })\n\n  if (interview == null) return null\n\n  cacheTag(getJobInfoIdTag(interview.jobInfo.id))\n  if (interview.jobInfo.userId !== userId) return null\n\n  return interview\n}\n\nasync function getInterviewIdsForJobInfo(jobInfoId: string, userId: string) {\n  const interviews = await db\n    .select({ id: InterviewsTable.id })\n    .from(InterviewsTable)\n    .innerJoin(JobInfoTable, eq(InterviewsTable.jobInfoId, JobInfoTable.id))\n    .where(\n      and(eq(InterviewsTable.jobInfoId, jobInfoId), eq(JobInfoTable.userId, userId))\n    )\n\n  return interviews.map(interview => interview.id)\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}