{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/data/env/client.ts"],"sourcesContent":["import { createEnv } from \"@t3-oss/env-nextjs\";\nimport { z } from \"zod\";\n\nexport const clientEnv = createEnv({\n  client: {\n    NEXT_PUBLIC_CLERK_SIGN_IN_URL: z.string().min(1),\n    NEXT_PUBLIC_CLERK_SIGN_IN_FALLBACK_REDIRECT_URL: z.string().min(1),\n    NEXT_PUBLIC_CLERK_SIGN_UP_FALLBACK_REDIRECT_URL: z.string().min(1),\n    NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY: z.string().min(1),\n    NEXT_PUBLIC_HUME_CONFIG_ID: z.string().min(1),\n  },\n  experimental__runtimeEnv: {\n    NEXT_PUBLIC_CLERK_SIGN_IN_URL: process.env.NEXT_PUBLIC_CLERK_SIGN_IN_URL,\n    NEXT_PUBLIC_CLERK_SIGN_IN_FALLBACK_REDIRECT_URL:\n      process.env.NEXT_PUBLIC_CLERK_SIGN_IN_FALLBACK_REDIRECT_URL,\n    NEXT_PUBLIC_CLERK_SIGN_UP_FALLBACK_REDIRECT_URL:\n      process.env.NEXT_PUBLIC_CLERK_SIGN_UP_FALLBACK_REDIRECT_URL,\n    NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY:\n      process.env.NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY,\n    NEXT_PUBLIC_HUME_CONFIG_ID: process.env.NEXT_PUBLIC_HUME_CONFIG_ID,\n  },\n  emptyStringAsUndefined: true,\n});\n"],"names":[],"mappings":";;;AAYmC;AAZnC;AACA;;;AAEO,MAAM,YAAY,IAAA,6KAAS,EAAC;IACjC,QAAQ;QACN,+BAA+B,0KAAC,CAAC,MAAM,GAAG,GAAG,CAAC;QAC9C,iDAAiD,0KAAC,CAAC,MAAM,GAAG,GAAG,CAAC;QAChE,iDAAiD,0KAAC,CAAC,MAAM,GAAG,GAAG,CAAC;QAChE,mCAAmC,0KAAC,CAAC,MAAM,GAAG,GAAG,CAAC;QAClD,4BAA4B,0KAAC,CAAC,MAAM,GAAG,GAAG,CAAC;IAC7C;IACA,0BAA0B;QACxB,6BAA6B;QAC7B,+CAA+C;QAE/C,iDACE,2KAAO,CAAC,GAAG,CAAC,+CAA+C;QAC7D,iCAAiC;QAEjC,0BAA0B;IAC5B;IACA,wBAAwB;AAC1B","debugId":null}},
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["file:///Users/sameershamsudheen/aijobprep/src/app/app/job-infos/%5BjobInfoId%5D/interviews/new/_StartCall.tsx"],"sourcesContent":["\"use client\"\n\nimport { Button } from \"@/components/ui/button\"\nimport { clientEnv } from \"@/data/env/client\"\nimport { JobInfoTable } from \"@/drizzle/schema\"\nimport { createInterview, updateInterview } from \"@/features/interviews/actions\"\nimport { errorToast } from \"@/lib/errorToast\"\nimport { CondensedMessages } from \"@/services/hume/components/CondensedMessages\"\nimport { condenseChatMessages } from \"@/services/hume/lib/condenseChatMessages\"\nimport { useVoice, VoiceReadyState } from \"@humeai/voice-react\"\nimport { Loader2Icon, MicIcon, MicOffIcon, PhoneOffIcon } from \"lucide-react\"\nimport { useRouter } from \"next/navigation\"\nimport { useEffect, useMemo, useRef, useState } from \"react\"\n\nexport function StartCall({\n  jobInfo,\n  user,\n  accessToken,\n}: {\n  accessToken: string\n  jobInfo: Pick<\n    typeof JobInfoTable.$inferSelect,\n    \"id\" | \"title\" | \"description\" | \"experienceLevel\"\n  >\n  user: {\n    name: string\n    imageUrl: string\n  }\n}) {\n  const { connect, readyState, chatMetadata, callDurationTimestamp } =\n    useVoice()\n  const [interviewId, setInterviewId] = useState<string | null>(null)\n  const durationRef = useRef(callDurationTimestamp)\n  const router = useRouter()\n  durationRef.current = callDurationTimestamp\n\n  // Sync chat ID\n  useEffect(() => {\n    if (chatMetadata?.chatId == null || interviewId == null) {\n      return\n    }\n    updateInterview(interviewId, { humeChatId: chatMetadata.chatId })\n  }, [chatMetadata?.chatId, interviewId])\n\n  // Sync duration\n  useEffect(() => {\n    if (interviewId == null) return\n    const intervalId = setInterval(() => {\n      if (durationRef.current == null) return\n\n      updateInterview(interviewId, { duration: durationRef.current })\n    }, 10000)\n\n    return () => clearInterval(intervalId)\n  }, [interviewId])\n\n  // Handle disconnect\n  useEffect(() => {\n    if (readyState !== VoiceReadyState.CLOSED) return\n    if (interviewId == null) {\n      return router.push(`/app/job-infos/${jobInfo.id}/interviews`)\n    }\n\n    if (durationRef.current != null) {\n      updateInterview(interviewId, { duration: durationRef.current })\n    }\n    router.push(`/app/job-infos/${jobInfo.id}/interviews/${interviewId}`)\n  }, [interviewId, readyState, router, jobInfo.id])\n\n  if (readyState === VoiceReadyState.IDLE) {\n    return (\n      <div className=\"flex justify-center items-center h-screen-header\">\n        <Button\n          size=\"lg\"\n          onClick={async () => {\n            const res = await createInterview({ jobInfoId: jobInfo.id })\n            if (res.error) {\n              return errorToast(res.message)\n            }\n            setInterviewId(res.id)\n\n            connect({\n              auth: { type: \"accessToken\", value: accessToken },\n              configId: clientEnv.NEXT_PUBLIC_HUME_CONFIG_ID,\n              sessionSettings: {\n                type: \"session_settings\",\n                variables: {\n                  userName: user.name,\n                  title: jobInfo.title || \"Not Specified\",\n                  description: jobInfo.description,\n                  experienceLevel: jobInfo.experienceLevel,\n                },\n              },\n            })\n          }}\n        >\n          Start Interview\n        </Button>\n      </div>\n    )\n  }\n\n  if (\n    readyState === VoiceReadyState.CONNECTING ||\n    readyState === VoiceReadyState.CLOSED\n  ) {\n    return (\n      <div className=\"h-screen-header flex items-center justify-center\">\n        <Loader2Icon className=\"animate-spin size-24\" />\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"overflow-y-auto h-screen-header flex flex-col-reverse\">\n      <div className=\"container py-6 flex flex-col items-center justify-end gap-4\">\n        <Messages user={user} />\n        <Controls />\n      </div>\n    </div>\n  )\n}\n\nfunction Messages({ user }: { user: { name: string; imageUrl: string } }) {\n  const { messages, fft } = useVoice()\n\n  const condensedMessages = useMemo(() => {\n    return condenseChatMessages(messages)\n  }, [messages])\n\n  return (\n    <CondensedMessages\n      messages={condensedMessages}\n      user={user}\n      maxFft={Math.max(...fft)}\n      className=\"max-w-5xl\"\n    />\n  )\n}\n\nfunction Controls() {\n  const { disconnect, isMuted, mute, unmute, micFft, callDurationTimestamp } =\n    useVoice()\n\n  return (\n    <div className=\"flex gap-5 rounded border px-5 py-2 w-fit sticky bottom-6 bg-background items-center\">\n      <Button\n        variant=\"ghost\"\n        size=\"icon\"\n        className=\"-mx-3\"\n        onClick={() => (isMuted ? unmute() : mute())}\n      >\n        {isMuted ? <MicOffIcon className=\"text-destructive\" /> : <MicIcon />}\n        <span className=\"sr-only\">{isMuted ? \"Unmute\" : \"Mute\"}</span>\n      </Button>\n      <div className=\"self-stretch\">\n        <FftVisualizer fft={micFft} />\n      </div>\n      <div className=\"text-sm text-muted-foreground tabular-nums\">\n        {callDurationTimestamp}\n      </div>\n      <Button\n        variant=\"ghost\"\n        size=\"icon\"\n        className=\"-mx-3\"\n        onClick={disconnect}\n      >\n        <PhoneOffIcon className=\"text-destructive\" />\n        <span className=\"sr-only\">End Call</span>\n      </Button>\n    </div>\n  )\n}\n\nfunction FftVisualizer({ fft }: { fft: number[] }) {\n  return (\n    <div className=\"flex gap-1 items-center h-full\">\n      {fft.map((value, index) => {\n        const percent = (value / 4) * 100\n        return (\n          <div\n            key={index}\n            className=\"min-h-0.5 bg-primary/75 w-0.5 rounded\"\n            style={{ height: `${percent < 10 ? 0 : percent}%` }}\n          />\n        )\n      })}\n    </div>\n  )\n}"],"names":[],"mappings":"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","debugId":null}}]
}